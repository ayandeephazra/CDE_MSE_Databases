Using the derived elastic impedance we compute the gradient of energy residual with respect to model vector directly, which allows us to implement the nonlinear inversion stably